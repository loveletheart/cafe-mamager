<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>주문 화면</title>
    <style>
        .screen {
            width: 300px;
            height: 300px;
            border: 1px solid #ccc;
            margin: 10px;
            float: left;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: box-shadow 0.3s ease-in-out;
            border-radius: 10px;
            position: relative;
        }
        .screen h2,
        .screen p {
            margin-left: 10px;
        }
        .screen hr {
            border: none;
            height: 2px;
            background-color: black;
        }
        .screen:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        .button {
            position: absolute;
            bottom: 10px;
            right: 10px;
            margin: 10px;
            padding: 5px 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .timer {
            float: right;
            margin-right: 10px;
            margin-top: 10px;
            font-size: 17px;
            font-weight: normal;
            font-family: Arial, sans-serif;
        }
    </style>
</head>
<body>
<div id="container"></div>
<script>
    var container = document.getElementById("container");
    var orderTimes = [];

    // 주문 화면 생성
    function createOrderScreen(index) {
        var div = document.createElement("div");
        div.className = "screen";
        div.innerHTML = "<h2>주문" + (index + 1) + " <span class='timer'></span></h2>";
        var hr = document.createElement("hr");
        div.appendChild(hr);

        // 추가 콘텐츠 생성
        for (var j = 0; j < 2; j++) {
            var additionalContent = document.createElement("p");
            additionalContent.innerHTML = "테스트" + j;
            div.appendChild(additionalContent);
        }

        // 주문 시간 기록
        var orderTime = new Date();
        orderTimes.splice(index, 0, orderTime); // 해당 인덱스에 시간 기록 삽입

        // 버튼 생성
        var button = document.createElement("button");
        button.textContent = "버튼 " + (index + 1);
        button.className = "button";

        // 클로저를 사용하여 해당 스크린의 인덱스를 기억
        button.addEventListener("click", (function (idx) {
            return function () {
                // 해당 스크린 삭제
                container.removeChild(container.childNodes[idx]);
                orderTimes.splice(idx, 1); // 해당 인덱스의 시간 기록 삭제
                updateElapsedTime();
            }
        })(index));

        div.appendChild(button);
        container.appendChild(div);

        // 경과 시간 업데이트
        updateElapsedTime();
    }

    // 주문 화면 생성
    for (var i = 0; i < 5; i++) {
        createOrderScreen(i);
    }

    // 경과 시간 업데이트 함수
    function updateElapsedTime() {
        for (var i = 0; i < container.children.length; i++) {
            (function (index) {
                setInterval(function () {
                    var currentTime = new Date();
                    var elapsedTime = Math.floor((currentTime - orderTimes[index]) / 1000);
                    var timerElement = container.querySelectorAll(".timer")[index];
                    timerElement.textContent = formatTime(elapsedTime);

                    // 경과 시간에 따라 내부 스크린 색상 변경
                    var screenElement = container.querySelectorAll(".screen")[index];
                    if (elapsedTime >= 600) {
                        // 10분 이상 경과 시 빨간색 배경색으로 변경 (투명도 50%)
                        screenElement.style.backgroundColor = "rgba(255, 0, 0, 0.5)";
                    } else if (elapsedTime >= 300) {
                        // 5분 이상 경과 시 주황색 배경색으로 변경 (투명도 50%)
                        screenElement.style.backgroundColor = "rgba(255, 165, 0, 0.5)";
                    } else {
                        // 그 외의 경우에는 초기 배경색(흰색)으로 변경
                        screenElement.style.backgroundColor = "white";
                    }
                }, 1000);
            })(i);
        }
    }

    // 시간 형식 포맷팅 함수
    function formatTime(time) {
        var hours = Math.floor(time / 3600);
        var minutes = Math.floor((time % 3600) / 60);
        var seconds = time % 60;

        return pad(hours) + ":" + pad(minutes) + ":" + pad(seconds);
    }

    // 숫자 포맷팅 함수
    function pad(num) {
        return (num < 10 ? "0" : "") + num;
    }
</script>
</body>
</html>
